{"version":3,"names":["createFragment","viewId","UIManager","dispatchViewManagerCommand","Wrld3dView","Commands","create","toString","processCommand","command","args","Marker","MarkerView","MapComponent","props","forwardedRef","useRef","isMapReady","moveToRegion","location","animated","duration","zoomLevel","Platform","OS","current","animateToRegion","moveToBuilding","highlight","dimensions","setDimensions","useState","width","height","ref","useEffect","findNodeHandle","mapStyles","PixelRatio","getPixelSizeForLayoutSize","onlayout","event","nativeEvent","layout","getMapCenter","message","NativeModules","getCameraBounds","getBuildingInformation","animateToBuilding","longitude","latitude","setBuildingHighlight","addBuildingHighlight","publicRef","useImperativeHandle","bind","style","overflow","Date","toDateString","initialCenter","onMapReady","precache","precacheDistance","children","React","forwardRef"],"sources":["index.tsx"],"sourcesContent":["import React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport {\n  findNodeHandle,\n  LayoutChangeEvent,\n  PixelRatio,\n  Platform,\n  UIManager,\n  View,\n} from 'react-native';\nimport { NativeModules } from 'react-native';\n\n\nimport { WrldMap3d, Marker as MarkerView, Wrld3dProps } from './MapViewManager';\nimport { Commands, MapViewNativeComponentType, Region } from './type';\n\n\n\nconst createFragment = (viewId: number) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // we are calling the 'create' command\n    // @ts-ignore\n    UIManager.Wrld3dView.Commands.create.toString(),\n    [viewId]\n  );\n\nconst processCommand = (viewId: number, command: string, args: any[]) => UIManager.dispatchViewManagerCommand(\n  viewId,\n  command,\n  args\n);\n\nexport const Marker = MarkerView;\n\nexport type MapViewRefPropsType = MapViewNativeComponentType;\n\nconst MapComponent: React.ForwardRefRenderFunction<MapViewNativeComponentType, Wrld3dProps> = (\n  props,\n  forwardedRef,\n) => {\n\n  const viewId = useRef<number>(0)\n  const isMapReady = useRef<boolean>();\n\n\n  const moveToRegion = ({ location, animated = false, duration = 5000, zoomLevel = -1 }: { location: Region, animated: boolean, duration?: number, zoomLevel?: number }) => {\n    if (Platform.OS === \"android\") {\n      processCommand(viewId.current, Commands.animateToRegion, [location, animated, duration, zoomLevel]);\n    }\n  }\n\n  const moveToBuilding = ({ location, highlight = false, zoomLevel = -1, animated = false, duration = 3000 }: { location: Region, highlight?: boolean, zoomLevel?: number, animated?: boolean, duration?: number }) => {\n    if (Platform.OS === \"android\") {\n      processCommand(viewId.current, Commands.moveToBuilding, [location, highlight, zoomLevel, animated, duration]);\n    }\n  }\n\n\n\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const ref = useRef<any>(null);\n\n  useEffect(() => {\n    if (Platform.OS === \"android\") {\n      viewId.current = findNodeHandle(ref.current) as number;\n      createFragment(viewId.current as number);\n    }\n  }, []);\n\n  const mapStyles = {\n    // converts dpi to px, provide desired height\n    height: PixelRatio.getPixelSizeForLayoutSize(dimensions.height),\n    // converts dpi to px, provide desired width\n    width: PixelRatio.getPixelSizeForLayoutSize(dimensions.width),\n  };\n\n\n  const onlayout = (event: LayoutChangeEvent) => {\n    const { width, height } = event.nativeEvent.layout;\n    setDimensions({ width: width, height: height });\n  }\n\n\n  const getMapCenter = async () => {\n    const message = await NativeModules['MapViewModule'].getCameraBounds(viewId.current);\n    return message;\n  }\n\n  const getBuildingInformation = async ({ location, animateToBuilding = false, duration = 2000, zoomLevel = 18 }: { location: Region, animateToBuilding?: boolean, duration?: number, zoomLevel?: number }) => {\n    const message = await NativeModules['MapViewModule'].getBuildingInformation(viewId.current, location.longitude, location.latitude, animateToBuilding, duration, zoomLevel);\n    return message;\n  }\n\n  const setBuildingHighlight = async ({ location }: { location: Region }) => {\n    const message = await NativeModules['MapViewModule'].addBuildingHighlight(viewId.current, location.longitude, location.latitude);\n    return message;\n  }\n\n  //mapevents\n  const publicRef = {\n    moveToRegion,\n    moveToBuilding,\n    getMapCenter,\n    getBuildingInformation,\n    setBuildingHighlight\n  };\n\n\n  useImperativeHandle(forwardedRef, () => publicRef);\n\n  return (\n    // <ProviderContext.Provider value={{ provider: 'wrld3dMap' }}>\n    <View onLayout={onlayout.bind(null)} style={[props.style ? props.style : { width: \"100%\", height: \"100%\" }, { overflow: \"hidden\" }]}>\n      <WrldMap3d\n        {...props}\n        key={new Date().toDateString()}\n        style={mapStyles}\n        // @ts-ignore\n        ref={ref}\n        zoomLevel={props.zoomLevel ? props.zoomLevel : 12}\n        initialCenter={props.initialCenter ? props.initialCenter : {\n          latitude: 24.8620502,\n          longitude: 67.0708794\n        }}\n        onMapReady={() => {\n          isMapReady.current = true;\n          if (props.onMapReady) {\n            props.onMapReady();\n          }\n        }}\n\n        precache={props.precache}\n        precacheDistance={props.precacheDistance}\n      >\n        {props.children}\n      </WrldMap3d>\n    </View>\n  )\n}\n\n\nexport const Wrld3dView = React.forwardRef(MapComponent);"],"mappings":"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"}