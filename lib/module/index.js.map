{"version":3,"names":["React","useEffect","useImperativeHandle","useRef","useState","findNodeHandle","PixelRatio","Platform","UIManager","View","NativeModules","WrldMap3d","Marker","MarkerView","Commands","createFragment","viewId","dispatchViewManagerCommand","Wrld3dView","create","toString","processCommand","command","args","MapComponent","props","forwardedRef","isMapReady","moveToRegion","location","animated","duration","zoomLevel","OS","current","animateToRegion","moveToBuilding","highlight","dimensions","setDimensions","width","height","ref","mapStyles","getPixelSizeForLayoutSize","onlayout","event","nativeEvent","layout","getMapCenter","message","getCameraBounds","publicRef","bind","style","overflow","initialCenter","latitude","longitude","onMapReady","precache","precacheDistance","children","forwardRef"],"sources":["index.tsx"],"sourcesContent":["import React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport {\n  findNodeHandle,\n  LayoutChangeEvent,\n  PixelRatio,\n  Platform,\n  UIManager,\n  View,\n} from 'react-native';\nimport { NativeModules } from 'react-native';\n\n\nimport { WrldMap3d, Marker as MarkerView, Wrld3dProps } from './MapViewManager';\nimport { Commands, MapViewNativeComponentType, Region } from './type';\n\n\n\nconst createFragment = (viewId: number) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // we are calling the 'create' command\n    // @ts-ignore\n    UIManager.Wrld3dView.Commands.create.toString(),\n    [viewId]\n  );\n\nconst processCommand = (viewId: number, command: string, args: any[]) => UIManager.dispatchViewManagerCommand(\n  viewId,\n  command,\n  args\n);\n\n\nexport const Marker = MarkerView;\n\nexport type MapViewRefPropsType = MapViewNativeComponentType;\n\nconst MapComponent: React.ForwardRefRenderFunction<MapViewNativeComponentType, Wrld3dProps> = (\n  props,\n  forwardedRef,\n) => {\n\n  const viewId = useRef<number>(0)\n  const isMapReady = useRef<boolean>();\n\n\n  const moveToRegion = ({ location, animated = false, duration = 5000, zoomLevel = -1 }: { location: Region, animated: boolean, duration?: number, zoomLevel?: number }) => {\n    if (Platform.OS === \"android\") {\n      processCommand(viewId.current, Commands.animateToRegion, [location, animated, duration, zoomLevel]);\n    }\n  }\n\n  const moveToBuilding = ({ location, highlight = false, zoomLevel = -1, animated = false, duration = 3000 }: { location: Region, highlight?: boolean, zoomLevel?: number, animated?: boolean, duration?: number }) => {\n    if (Platform.OS === \"android\") {\n      processCommand(viewId.current, Commands.moveToBuilding, [location, highlight, zoomLevel, animated, duration]);\n    }\n  }\n\n\n\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const ref = useRef<any>(null);\n\n  useEffect(() => {\n    if (Platform.OS === \"android\") {\n      viewId.current = findNodeHandle(ref.current) as number;\n      createFragment(viewId.current as number);\n    }\n  }, []);\n\n  const mapStyles = {\n    // converts dpi to px, provide desired height\n    height: PixelRatio.getPixelSizeForLayoutSize(dimensions.height),\n    // converts dpi to px, provide desired width\n    width: PixelRatio.getPixelSizeForLayoutSize(dimensions.width),\n  };\n\n\n  const onlayout = (event: LayoutChangeEvent) => {\n    const { width, height } = event.nativeEvent.layout;\n    setDimensions({ width: width, height: height });\n  }\n\n\n  const getMapCenter = async () => {\n    const message = await NativeModules['MapViewModule'].getCameraBounds(viewId.current);\n    return message;\n  }\n\n  //mapevents\n  const publicRef = {\n    moveToRegion,\n    moveToBuilding,\n    getMapCenter\n  };\n\n\n  useImperativeHandle(forwardedRef, () => publicRef);\n\n  return (\n    <View onLayout={onlayout.bind(null)} style={[props.style ? props.style : { width: \"100%\", height: \"100%\" }, { overflow: \"hidden\" }]}>\n      <WrldMap3d\n        {...props}\n        style={mapStyles}\n        // @ts-ignore\n        ref={ref}\n        zoomLevel={props.zoomLevel ? props.zoomLevel : 12}\n        initialCenter={props.initialCenter ? props.initialCenter : {\n          latitude: 24.8620495,\n          longitude: 67.070877\n        }}\n        onMapReady={() => {\n          isMapReady.current = true;\n          if (props.onMapReady) {\n            props.onMapReady();\n          }\n        }}\n\n        precache={props.precache}\n        precacheDistance={props.precacheDistance}\n      >\n        {props.children}\n      </WrldMap3d>\n    </View>\n\n  )\n}\n\n\nexport const Wrld3dView = React.forwardRef(MapComponent);"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,mBAA3B,EAAgDC,MAAhD,EAAwDC,QAAxD,QAAwE,OAAxE;AACA,SACEC,cADF,EAGEC,UAHF,EAIEC,QAJF,EAKEC,SALF,EAMEC,IANF,QAOO,cAPP;AAQA,SAASC,aAAT,QAA8B,cAA9B;AAGA,SAASC,SAAT,EAAoBC,MAAM,IAAIC,UAA9B,QAA6D,kBAA7D;AACA,SAASC,QAAT,QAA6D,QAA7D;;AAIA,MAAMC,cAAc,GAAIC,MAAD,IACrBR,SAAS,CAACS,0BAAV,CACED,MADF,EAEE;AACA;AACAR,SAAS,CAACU,UAAV,CAAqBJ,QAArB,CAA8BK,MAA9B,CAAqCC,QAArC,EAJF,EAKE,CAACJ,MAAD,CALF,CADF;;AASA,MAAMK,cAAc,GAAG,CAACL,MAAD,EAAiBM,OAAjB,EAAkCC,IAAlC,KAAkDf,SAAS,CAACS,0BAAV,CACvED,MADuE,EAEvEM,OAFuE,EAGvEC,IAHuE,CAAzE;;AAOA,OAAO,MAAMX,MAAM,GAAGC,UAAf;;AAIP,MAAMW,YAAqF,GAAG,CAC5FC,KAD4F,EAE5FC,YAF4F,KAGzF;EAEH,MAAMV,MAAM,GAAGb,MAAM,CAAS,CAAT,CAArB;EACA,MAAMwB,UAAU,GAAGxB,MAAM,EAAzB;;EAGA,MAAMyB,YAAY,GAAG,QAAqJ;IAAA,IAApJ;MAAEC,QAAF;MAAYC,QAAQ,GAAG,KAAvB;MAA8BC,QAAQ,GAAG,IAAzC;MAA+CC,SAAS,GAAG,CAAC;IAA5D,CAAoJ;;IACxK,IAAIzB,QAAQ,CAAC0B,EAAT,KAAgB,SAApB,EAA+B;MAC7BZ,cAAc,CAACL,MAAM,CAACkB,OAAR,EAAiBpB,QAAQ,CAACqB,eAA1B,EAA2C,CAACN,QAAD,EAAWC,QAAX,EAAqBC,QAArB,EAA+BC,SAA/B,CAA3C,CAAd;IACD;EACF,CAJD;;EAMA,MAAMI,cAAc,GAAG,SAA8L;IAAA,IAA7L;MAAEP,QAAF;MAAYQ,SAAS,GAAG,KAAxB;MAA+BL,SAAS,GAAG,CAAC,CAA5C;MAA+CF,QAAQ,GAAG,KAA1D;MAAiEC,QAAQ,GAAG;IAA5E,CAA6L;;IACnN,IAAIxB,QAAQ,CAAC0B,EAAT,KAAgB,SAApB,EAA+B;MAC7BZ,cAAc,CAACL,MAAM,CAACkB,OAAR,EAAiBpB,QAAQ,CAACsB,cAA1B,EAA0C,CAACP,QAAD,EAAWQ,SAAX,EAAsBL,SAAtB,EAAiCF,QAAjC,EAA2CC,QAA3C,CAA1C,CAAd;IACD;EACF,CAJD;;EAQA,MAAM,CAACO,UAAD,EAAaC,aAAb,IAA8BnC,QAAQ,CAAC;IAAEoC,KAAK,EAAE,CAAT;IAAYC,MAAM,EAAE;EAApB,CAAD,CAA5C;EACA,MAAMC,GAAG,GAAGvC,MAAM,CAAM,IAAN,CAAlB;EAEAF,SAAS,CAAC,MAAM;IACd,IAAIM,QAAQ,CAAC0B,EAAT,KAAgB,SAApB,EAA+B;MAC7BjB,MAAM,CAACkB,OAAP,GAAiB7B,cAAc,CAACqC,GAAG,CAACR,OAAL,CAA/B;MACAnB,cAAc,CAACC,MAAM,CAACkB,OAAR,CAAd;IACD;EACF,CALQ,EAKN,EALM,CAAT;EAOA,MAAMS,SAAS,GAAG;IAChB;IACAF,MAAM,EAAEnC,UAAU,CAACsC,yBAAX,CAAqCN,UAAU,CAACG,MAAhD,CAFQ;IAGhB;IACAD,KAAK,EAAElC,UAAU,CAACsC,yBAAX,CAAqCN,UAAU,CAACE,KAAhD;EAJS,CAAlB;;EAQA,MAAMK,QAAQ,GAAIC,KAAD,IAA8B;IAC7C,MAAM;MAAEN,KAAF;MAASC;IAAT,IAAoBK,KAAK,CAACC,WAAN,CAAkBC,MAA5C;IACAT,aAAa,CAAC;MAAEC,KAAK,EAAEA,KAAT;MAAgBC,MAAM,EAAEA;IAAxB,CAAD,CAAb;EACD,CAHD;;EAMA,MAAMQ,YAAY,GAAG,YAAY;IAC/B,MAAMC,OAAO,GAAG,MAAMxC,aAAa,CAAC,eAAD,CAAb,CAA+ByC,eAA/B,CAA+CnC,MAAM,CAACkB,OAAtD,CAAtB;IACA,OAAOgB,OAAP;EACD,CAHD,CA5CG,CAiDH;;;EACA,MAAME,SAAS,GAAG;IAChBxB,YADgB;IAEhBQ,cAFgB;IAGhBa;EAHgB,CAAlB;EAOA/C,mBAAmB,CAACwB,YAAD,EAAe,MAAM0B,SAArB,CAAnB;EAEA,oBACE,oBAAC,IAAD;IAAM,QAAQ,EAAEP,QAAQ,CAACQ,IAAT,CAAc,IAAd,CAAhB;IAAqC,KAAK,EAAE,CAAC5B,KAAK,CAAC6B,KAAN,GAAc7B,KAAK,CAAC6B,KAApB,GAA4B;MAAEd,KAAK,EAAE,MAAT;MAAiBC,MAAM,EAAE;IAAzB,CAA7B,EAAgE;MAAEc,QAAQ,EAAE;IAAZ,CAAhE;EAA5C,gBACE,oBAAC,SAAD,eACM9B,KADN;IAEE,KAAK,EAAEkB,SAFT,CAGE;IAHF;IAIE,GAAG,EAAED,GAJP;IAKE,SAAS,EAAEjB,KAAK,CAACO,SAAN,GAAkBP,KAAK,CAACO,SAAxB,GAAoC,EALjD;IAME,aAAa,EAAEP,KAAK,CAAC+B,aAAN,GAAsB/B,KAAK,CAAC+B,aAA5B,GAA4C;MACzDC,QAAQ,EAAE,UAD+C;MAEzDC,SAAS,EAAE;IAF8C,CAN7D;IAUE,UAAU,EAAE,MAAM;MAChB/B,UAAU,CAACO,OAAX,GAAqB,IAArB;;MACA,IAAIT,KAAK,CAACkC,UAAV,EAAsB;QACpBlC,KAAK,CAACkC,UAAN;MACD;IACF,CAfH;IAiBE,QAAQ,EAAElC,KAAK,CAACmC,QAjBlB;IAkBE,gBAAgB,EAAEnC,KAAK,CAACoC;EAlB1B,IAoBGpC,KAAK,CAACqC,QApBT,CADF,CADF;AA2BD,CAzFD;;AA4FA,OAAO,MAAM5C,UAAU,gBAAGlB,KAAK,CAAC+D,UAAN,CAAiBvC,YAAjB,CAAnB"}